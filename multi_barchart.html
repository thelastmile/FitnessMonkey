<!DOCTYPE html>
<head>
	<title>Fitness Monkey Site</title>
	<!-- meta data -->
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<!-- bootstrap 3 -->
	<link rel="stylesheet" type="text/css" href="bootstrap/bootstrap-3.3.5/css/bootstrap.min.css">
	<!-- my styles -->
	<link rel="stylesheet" type="text/css" href="lib/nv.d3.min.css">
	<!-- <link rel="stylesheet" type="text/css" href="css/working_copy.css"> -->
	<script type="text/javascript" src="lib/d3.v3.js"></script>
	<script type="text/javascript" src="lib/nv.d3.min.js"></script>
	<style type="text/css">
		#multi-bar-chart svg {
			width: 100%;
			height: 400px;
			background-color: lightgray;
		}

	</style>
</head>

<body>
	<div class="container">
		<h1>Multi Bar Chart</h1>
		<div id="multi-bar-chart">
			<svg></svg>
		</div>

	</div>

	<script type="text/javascript">
		var workoutData;
		function loadData(data){
			workoutData = data.workouts;
			buildMultiBarChart(dataTransformer.typeMultiBarChart(workoutData), "Duration of Workouts", "#multi-bar-chart svg");
		}

		d3.json('../data/new_workouts.json', loadData);

		function buildMultiBarChart(data, title, selector){
			var chart;
		    nv.addGraph(function() {
		        chart = nv.models.multiBarChart()
		            .barColor(d3.scale.category20().range())
		            .duration(300)
		            .margin({bottom: 100, left: 70})
		            .rotateLabels(45)
		            .groupSpacing(0.1)
		        ;

		        chart.reduceXTicks(false).staggerLabels(true);

		        chart.xAxis
		            .axisLabel("Dates")
		            .axisLabelDistance(35)
		            .showMaxMin(false)
		            .tickFormat(d3.format(',.6f'))
		        ;

		        chart.yAxis
		            .axisLabel(title)
		            .axisLabelDistance(-5)
		            .tickFormat(d3.format(',.01f'))
		        ;

		        chart.dispatch.on('renderEnd', function(){
		            nv.log('Render Complete');
		        });

		        d3.select('#chart1 svg')
		            .datum(data)
		            .call(chart);

		        nv.utils.windowResize(chart.update);

		        chart.dispatch.on('stateChange', function(e) {
		            nv.log('New State:', JSON.stringify(e));
		        });
		        chart.state.dispatch.on('change', function(state){
		            nv.log('state', JSON.stringify(state));
		        });

		        return chart;
		    });
		}

		var dataTransformer = {
			typeMultiBarChart: function(data){
				console.log(data);
			}
		}
	</script>



	<script type="text/javascript" src="lib/jquery.js"></script>
	<script type="text/javascript" src="bootstrap/bootstrap-3.3.5/js/bootstrap.min.js"></script>
	<script type="text/javascript" src="lib/holderJS_lite/lib/holder.min.js"></script>
	<script type="text/javascript" src="scripts/script.js"></script>
	<script type="text/javascript" src="scripts/working_copy_d3.js"></script>
</body>